rm(list=ls())
setwd("E:/Dropbox/Statistics/Function")
source("./function/corcoef.test.r")

test <- data.frame(
  X1=c(191,193,189,211,176,169,154,193,176,156,
       189,162,182,167,154,166,247,202,157,138),
  X2=c(36,38,35,38,31,34,34,36,37,33,
       37,35,36,34,33,33,46,37,32,33),
  X3=c(50,58,46,56,74,50,64,46,54,54,
       52,62,56,60,56,52,50,62,52,68),
  Y1=c(05,12,13,08,15,17,14,06,04,15,
       02,12,04,06,17,13,01,12,11,02),
  Y2=c(162,101,155,101,200,120,215,070,060,225,
       110,105,101,125,251,210,050,210,230,110),
  Y3=c(060,101,058,038,040,038,105,031,025,073,
       060,037,042,040,250,115,050,120,080,043)
  )

test <- scale(test)
ca <- cancor(test[,1:3], test[,4:6])

U <- as.matrix(test[,1:3]) %*% ca$xcoef
V <- as.matrix(test[,4:6]) %*% ca$ycoef

plot(U[,1], V[,1], xlab="U1", ylab="V1", pch=20)
plot(U[,2], V[,2], xlab="U2", ylab="V2", pch=20)
plot(U[,3], V[,3], xlab="U3", ylab="V3", pch=20)

corcoef.test(r=ca$cor, n=20, p=3, q=3, alpha=0.1)
